<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jy.mapper.EmployeeMapper">

  <resultMap type="com.jy.domain.EmployeeVO" id="EmployeeMap">
  <!-- prop=vo column=db -->
    <id property="userid" column="userid"/>
    <result property="userid" column="userid"/>
    <result property="userpw" column="userpw"/>  
    <result property="usernickname" column="usernickname"/>
    <result property="useremail" column="useremail"/>
    <result property="token" column="token"/>
    <collection property="authSet" resultMap="authMap">
    </collection> 
  </resultMap>
  
  <resultMap type="com.jy.domain.AuthVO" id="authMap">
    <result property="userid" column="userid"/>
    <result property="auth" column="auth"/>
  </resultMap>
  
  <!-- MemberMapper의 메서드와 매핑. resultMap 속성값 지정-->
  <select id="read" resultMap="EmployeeMap">
	SELECT 
		emp.userid, userpw, usernickname, useremail, token, auth
	 FROM 
	 	employee emp LEFT OUTER JOIN autho auth on emp.userid = auth.userid 
	 WHERE 
	 	emp.userid = #{userid} 
  </select>

	<insert id="createEmployee">
		insert into employee(userid
							, userpw
							, usernickname
							, useremail
							, token) 
					values(#{userid}
							, #{userpw}
							, #{usernickname}
							, #{useremail}
							, #{token}
		)
	</insert>
	
	<insert id="createAuth">
		insert into autho(userid, auth) 
		values(#{userid}, #{auth})
	</insert>
	
	<select id="duplicateCheckUserid" resultType="com.jy.domain.EmployeeVO">
		select * from employee where userid = #{userid}
	</select>
	
	<select id="duplicateCheckUseremail" resultType="com.jy.domain.EmployeeVO">
		select * from employee where useremail = #{useremail}
	</select>
</mapper>
